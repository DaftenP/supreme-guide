<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.enjoytrips.model.dao.QnaDao">

    <!-- 글 조회 (댓글 포함)   -->
    <select id="select" parameterType="int" resultMap="QnaWithComments">
--         SELECT qna_id, qna_title, qna_content, qna_view, qna_writer FROM qna WHERE qna_id = #{qnaId}
        SELECT q.qna_id, q.qna_title, q.qna_content, q.qna_view, q.qna_writer, q.qna_createtime,
            qc.qna_comment_id, qc.qna_comment_content, qc.qna_comment_harmful, qc.qna_id as comment_qna_id, qc.user_id as comment_user_id
        FROM qna q
            LEFT JOIN qna_comment qc ON q.qna_id = qc.qna_id
        WHERE q.qna_id = #{qnaId}
    </select>


<!--    &lt;!&ndash;  댓글 전체 조회  &ndash;&gt;-->
<!--    <select id="selectWithComments" parameterType="int" resultMap="QnaWithComments">-->
<!--        SELECT qna_id, qna_title, qna_content, qna_view, qna_writer FROM qna WHERE qna_id = #{qnaId};-->
<!--        SELECT qna_comment_id, qna_comment_content, qna_content_harmful, qna_qna_id, user_user_id FROM qna_comment WHERE qna_id = #{qnaId}-->
<!--    </select>-->

    <resultMap id="QnaWithComments" type="Qna">
        <result property="qnaId" column="qna_id"/>
        <result property="qnaTitle" column="qna_title" />
        <result property="qnaContent" column="qna_content" />
        <result property="qnaView" column="qna_view" />
        <result property="qnaWriter" column="qna_writer"/>
        <collection property="comments" ofType="qnaComment">
            <id property="qnaCommentId" column="qna_comment_id" />
            <result property="qnaCommentContent" column="qna_comment_content" />
            <result property="qnaCommentHarmful" column="qna_comment_harmful" />
            <result property="qnaId" column="qna_qna_id" />
            <result property="userId" column="user_user_id" />
        </collection>
    </resultMap>

</mapper>